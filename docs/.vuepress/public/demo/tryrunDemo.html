<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>tryhtml_elements_1 在线代码实例_w3cschool</title>
    <meta
      name="keywords"
      content="代码实例,代码示例,代码案例,在线运行,在线编译,在线预览"
    />
    <meta
      name="description"
      content="支持在线代码运行, 在线修改代码, 在线查看运行结果。"
    />

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <script src="./asset/ace.js" type="text/javascript"></script>
    <script src="./asset/mode-html.js" type="text/javascript"></script>
    <script src="./asset/theme-xcode.js" type="text/javascript"></script>
    <script src="./asset/base64.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="./asset/runcode.css" />
    <script src="./asset/jquery-1.8.3.min.js" type="text/javascript"></script>
    <script id="mycode" type="text/mycode">
      PCFET0NUWVBFIGh0bWw+DQo8aHRtbD4NCjxoZWFkPg0KICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4NCiAgICA8dGl0bGU+57yW56iL54uuKHczY3NjaG9vbC5jbik8L3RpdGxlPg0KPC9oZWFkPg0KPGJvZHk+DQogDQogICAgPHA+6L+Z5piv56ys5LiA5Liq5q616JC944CCPC9wPg0KIA0KPC9ib2R5Pg0KPC9odG1sPg==
    </script>    
  </head>
  <body id="editor">
    <div class="container-fluid content-box">
      <div class="editor-box left-box">
        <div class="text-wrap editor-wrap">
          <div class="top-con">
            <div class="top-con-text">
              <span>实例代码</span>
            </div>
            <div class="top-con-btn top-con-operate">
              <!-- <a id="savecode"  class="btn btn-default" href="javascript:void(0);" uid="3953577" >保存代码</a> -->
              <!-- <a href="/my#mycode" class="btn btn-default">我的代码</a> -->
              <a
                id="btrun"
                class="btn btn-run"
                href="javascript:void(0);"
                hidefocus="true"
                ><span>运行代码</span></a
              >
            </div>
          </div>
          <div id="code" class="text-panel">
            <div id="codeprepare"></div>
          </div>
        </div>
      </div>
      <div id="result-box" class="result-box right-box">
        <div class="text-wrap result-wrap">
          <div class="top-con">
            <div class="top-con-text">
              <span>运行结果</span>
            </div>
            <div class="top-con-btn top-con-device" style="display: none;">
              <a
                href="javascript:;"
                class="btn active"
                onclick="changeView(this);"
                data-type="pc"
                ><span>PC端</span></a
              >
              <a
                href="javascript:;"
                class="btn"
                onclick="changeView(this);"
                data-type="mobile"
                ><span>手机端</span></a
              >
              <a
                href="javascript:;"
                class="btn"
                onclick="changeView(this);"
                data-type="pad"
                ><span>平板端</span></a
              >
            </div>
          </div>
          <div class="text-panel">
            <div id="demotype" class="pc">
                <iframe id="preview"  sandbox="allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts"></iframe>
            </div>
        </div>
      </div>
    </div>

    <script type="text/javascript">
      let mycode = $("#mycode").html();
      mycode = utf8to16(base64decode(mycode));
      let btrun = document.getElementById("btrun");
      let htmlCode=`<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>编程狮(w3cschool.cn)</title>
</head>
<body>
 
    <p>这是第一个段落。</p>
 
</body>
</html>`
      let editor = ace.edit("codeprepare");
      editor.session.setMode("ace/mode/html");
      editor.setTheme("ace/theme/xcode");
      // enable autocompletion and snippets
      editor.setOptions({
        enableBasicAutocompletion: true,
        enableSnippets: true,
        enableLiveAutocompletion: true,
        autoScrollEditorIntoView: true,
        maxLines: 34,
        minLines: 33,
      });
      editor.renderer.setScrollMargin(10, 10, 10, 10);
      editor.setFontSize(14);
      editor.setValue(htmlCode);
      let tips = "将HTML代码粘在此处，点击运行即可。";
      function runEditor(code) {
        var previewFrame = document.querySelector("#preview")
        var preview =  previewFrame.contentDocument ||  previewFrame.contentWindow.document

        preview.open()
        preview.write(code)
        //preview.write("<style>"+ cssEditor.value +"</style>" + htmlEditor.value + "<scr"+"ipt>"+ jsEditor.value +"</scr"+"ipt>")
        preview.close()
        }
      $(btrun).click(function () {
          var code = editor.getValue();
          if (code != tips) {
            runEditor(code)
            //console.log(code)
          }})
    </script>
  </body>
</html>
